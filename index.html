<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />

    <link rel="stylesheet" type="text/css" href="stylesheets/reset.css">
    <link rel="stylesheet" type="text/css" href="stylesheets/main.css">

    <link href="https://fonts.googleapis.com/css?family=Oxygen+Mono" rel="stylesheet">

    <title>mkondratek</title>
</head>
<body>
<div id="header"></div>
<div id="content">
    <div id="status"><br />Work in progress...</div>

    <script>
        function check_status() {
            document.getElementById("status").innerHTML = Date() + "<br />Work still in progress.";
        }
    </script>

</div>
<div id="check"><button type="button" onclick="check_status()">check status</button></div>
<div id="game">

    <script>
        window.onload = function () { setLetters(); };

        var buttonsLeft = 9;

        function containsVowel(text) {
            return ['a', 'e', 'i', 'o', 'u', 'y'].indexOf(text.toLowerCase()) !== -1;
        }

        function rand(a, b) {
            if (a % 1 !== 0 || b % 1 !== 0 || a > b) return 0;
            return Math.floor((Math.random() * Math.pow(10, b.toString().length) % (b - a + 1)) + a);
        }

        function randLetter() {
            return String.fromCharCode(rand("A".charCodeAt(0), "Z".charCodeAt(0)));
        }

        function roll(element) {
            var next;
            var state;

            if (containsVowel(element.innerHTML) || buttonsLeft === 9) state = "none";
            else state = "block";

            do {
                next = "b" + rand(1, 3).toString() + rand(1, 3).toString();
            } while (document.getElementById(next).style.display === state);
            swapVisibility(document.getElementById(next));
        }

        function setLetters() {
            for (i=1; i<4; i++) {
                for (j=1; j<4; j++) {
                    var element = document.getElementById("b" + i.toString() + j.toString());
                    element.innerHTML = randLetter();
                    element.style.display = "block";
                }
            }
        }

        function swapVisibility(element) {
            if (element.style.display === "none") {
                buttonsLeft++;
                element.style.display = "block";
                element.innerHTML = randLetter();
            } else {
                buttonsLeft--;
                element.style.display = "none";
                if (buttonsLeft === 0) {
                    buttonsLeft = 9;
                    setLetters();
                    document.getElementById("win").innerHTML = "You did it Mastermind! Congratulations :)";
                }
            }
        }
    </script>
    <table>
        <tr>
            <td>
                <button id="b11" onclick="roll(this)">?</button>
            </td>
            <td>
                <button id="b12" onclick="roll(this)">?</button>
            </td>
            <td>
                <button id="b13" onclick="roll(this)">?</button>
            </td>
        </tr>
        <tr>
            <td>
                <button id="b21" onclick="roll(this)">?</button>
            </td>
            <td>
                <button id="b22" onclick="roll(this)">?</button>
            </td>
            <td>
                <button id="b23" onclick="roll(this)">?</button>
            </td>
        </tr>
        <tr>
            <td>
                <button id="b31" onclick="roll(this)">?</button>
            </td>
            <td>
                <button id="b32" onclick="roll(this)">?</button>
            </td>
            <td>
                <button id="b33" onclick="roll(this)">?</button>
            </td>
        </tr>
    </table>
</div>
<div id="win"></div>
<div id="footer">Created by mkondratek Â© <a href="mailto:m.kondratek@o2.pl" id="mail">m.kondratek@o2.pl</a>?</div>
</body>
</html>